# RF Tactical - Windows Development Rules

## Platform Compatibility
- Target: Raspberry Pi 5 (ARM64 Linux) for deployment
- Dev environment: Windows x64
- ALL code must work on both platforms

## Critical Requirements

### File Paths
- Use `pathlib.Path` ALWAYS
- Example: `Path.home() / "rf_tactical" / "recordings"`
- NEVER: `/home/pi/rf_tactical/recordings`

### Hardware Dependencies
```python
# Pattern for all hardware imports:
try:
    import SoapySDR
    sdr = SoapySDR.Device(dict(driver="hackrf"))
except (ImportError, RuntimeError):
    sdr = None
    MOCK_MODE = True
```

### System Commands
```python
# Pattern for subprocess calls:
import sys
if sys.platform == 'linux':
    subprocess.run(['hackrf_info'])
else:
    # Windows: skip or mock
    pass
```

### Testing Requirements
- Create unit tests for ALL new code in `tests/` folder
- Mock hardware dependencies
- Tests must pass on Windows (without hardware)
- Example test structure:
```python
import unittest
from unittest.mock import Mock, patch

class TestSDRManager(unittest.TestCase):
    @patch('radio.sdr_manager.SoapySDR')
    def test_without_hardware(self, mock_soapy):
        # Test code here
        pass
```

## Task Workflow
1. Scan code for platform issues FIRST
2. Fix compatibility problems
3. Create/update tests
4. Verify tests pass on Windows
5. Then implement new features

## Current Priority
**Scan entire codebase for:**
- Hardcoded Linux paths (starting with `/`)
- `subprocess.run()` without platform checks
- Hardware imports without try/except
- System file reads without existence checks

Report findings with file:line and suggested fixes.
```

---

## üöÄ **NEXT STEPS**

**After adding the rule:**

1. **Verify it's active:**
```
   Click ‚öñÔ∏è in Cline ‚Üí Check "Workspace Rules" ‚Üí See .clinerules enabled
```

2. **Give Cline this task:**
```
   Follow the platform compatibility rules in .clinerules.
   
   Task: Scan the entire rf_tactical codebase and create a detailed report of all platform-specific code that will break on Windows.
   
   Search for:
   1. Hardcoded Linux paths (any string starting with "/" that looks like a path)
   2. subprocess calls without platform checks (hackrf_info, rtl_433, dump1090, etc.)
   3. Hardware imports without error handling (import SoapySDR, import gpsd)
   4. System file reads (/proc/stat, /sys/class/thermal/, /sys/class/backlight/)
   
   For each issue found, provide:
   - File path and line number
   - Current code snippet
   - Suggested cross-platform fix
   - Severity (CRITICAL/HIGH/MEDIUM/LOW)
   
   Create the report, then ask me which issues to fix first.
```

3. **Cline will scan and create a prioritized fix list**

---

## ‚ö° **Quick Test**

**To verify the rule is working, ask Cline:**
```
What are the platform compatibility rules for this project?